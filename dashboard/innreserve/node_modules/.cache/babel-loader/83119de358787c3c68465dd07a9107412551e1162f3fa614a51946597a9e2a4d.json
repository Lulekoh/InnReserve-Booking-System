{"ast":null,"code":"import React,{useReducer}from'react';import axios from'axios';import AuthContext from'./AuthContext';import authReducer from'../reducers/authReducer';import setAuthToken from'../utils/setAuthToken';import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,AUTH_ERROR,LOGIN_SUCCESS,LOGIN_FAIL,LOGOUT}from'../types';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthState=props=>{const initialState={token:localStorage.getItem('token'),isAuthenticated:null,loading:true,user:null,error:null};const[state,dispatch]=useReducer(authReducer,initialState);const loadUser=async()=>{if(localStorage.token){setAuthToken(localStorage.token);}try{const res=await axios.get('/api/auth');dispatch({type:USER_LOADED,payload:res.data});}catch(err){dispatch({type:AUTH_ERROR});}};const register=async formData=>{const config={headers:{'Content-Type':'application/json'}};try{const res=await axios.post('/api/auth/register',formData,config);dispatch({type:REGISTER_SUCCESS,payload:res.data});loadUser();}catch(err){dispatch({type:REGISTER_FAIL,payload:err.response.data.message});}};const login=async formData=>{const config={headers:{'Content-Type':'application/json'}};try{const res=await axios.post('/api/auth/login',formData,config);dispatch({type:LOGIN_SUCCESS,payload:res.data});loadUser();}catch(err){dispatch({type:LOGIN_FAIL,payload:err.response.data.message});}};const logout=()=>{dispatch({type:LOGOUT});};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,user:state.user,error:state.error,register,loadUser,login,logout},children:props.children});};export default AuthState;","map":{"version":3,"names":["React","useReducer","axios","AuthContext","authReducer","setAuthToken","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","AUTH_ERROR","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","jsx","_jsx","AuthState","props","initialState","token","localStorage","getItem","isAuthenticated","loading","user","error","state","dispatch","loadUser","res","get","type","payload","data","err","register","formData","config","headers","post","response","message","login","logout","Provider","value","children"],"sources":["/InnReserve-Booking-System/dashboard/innreserve/src/context/AuthState.js"],"sourcesContent":["import React, { useReducer } from 'react';\nimport axios from 'axios';\nimport AuthContext from './AuthContext';\nimport authReducer from '../reducers/authReducer';\nimport setAuthToken from '../utils/setAuthToken';\nimport {\n  REGISTER_SUCCESS,\n  REGISTER_FAIL,\n  USER_LOADED,\n  AUTH_ERROR,\n  LOGIN_SUCCESS,\n  LOGIN_FAIL,\n  LOGOUT,\n} from '../types';\n\nconst AuthState = (props) => {\n  const initialState = {\n    token: localStorage.getItem('token'),\n    isAuthenticated: null,\n    loading: true,\n    user: null,\n    error: null,\n  };\n\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  const loadUser = async () => {\n    if (localStorage.token) {\n      setAuthToken(localStorage.token);\n    }\n\n    try {\n      const res = await axios.get('/api/auth');\n\n      dispatch({\n        type: USER_LOADED,\n        payload: res.data,\n      });\n    } catch (err) {\n      dispatch({\n        type: AUTH_ERROR,\n      });\n    }\n  };\n\n  const register = async (formData) => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    try {\n      const res = await axios.post('/api/auth/register', formData, config);\n\n      dispatch({\n        type: REGISTER_SUCCESS,\n        payload: res.data,\n      });\n\n      loadUser();\n    } catch (err) {\n      dispatch({\n        type: REGISTER_FAIL,\n        payload: err.response.data.message,\n      });\n    }\n  };\n\n  const login = async (formData) => {\n    const config = {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n\n    try {\n      const res = await axios.post('/api/auth/login', formData, config);\n\n      dispatch({\n        type: LOGIN_SUCCESS,\n        payload: res.data,\n      });\n\n      loadUser();\n    } catch (err) {\n      dispatch({\n        type: LOGIN_FAIL,\n        payload: err.response.data.message,\n      });\n    }\n  };\n\n  const logout = () => {\n    dispatch({ type: LOGOUT });\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        token: state.token,\n        isAuthenticated: state.isAuthenticated,\n        loading: state.loading,\n        user: state.user,\n        error: state.error,\n        register,\n        loadUser,\n        login,\n        logout,\n      }}\n    >\n      {props.children}\n    </AuthContext.Provider>\n  );\n};\n\nexport default AuthState;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}